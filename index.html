<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Files in New Folder</title>
</head>
<body>
    <h1>Files in New Folder</h1>
    <ul id="fileList">
        <!-- Files will be dynamically added here -->
    </ul>

    <script>
        // Function to fetch and display files from GitHub API
        async function fetchFiles() {
            const repo = 'cvhiidrepox8002/ucphliorapdveirdeo';
            const token = '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';
            const url = `https://api.github.com/repos/${repo}/contents/new`;

            try {
                const response = await fetch(url, {
                    headers: {
                        'Authorization': `token ${token}`
                    }
                });
                const files = await response.json();

                // Clear previous list items
                const fileList = document.getElementById('fileList');
                fileList.innerHTML = '';

                // Iterate through files and create list items
                files.forEach(file => {
                    const fileName = file.name;
                    const fileURL = file.download_url;

                    const li = document.createElement('li');
                    const a = document.createElement('a');
                    a.textContent = fileName;
                    a.href = fileURL;
                    a.target = '_blank';

                    const deleteButton = document.createElement('button');
                    deleteButton.textContent = 'Delete';
                    deleteButton.addEventListener('click', async () => {
                        const deleteURL = file.url;
                        try {
                            const deleteResponse = await fetch(deleteURL, {
                                method: 'DELETE',
                                headers: {
                                    'Authorization': `token ${token}`,
                                    'Accept': 'application/vnd.github.v3+json'
                                }
                            });
                            if (deleteResponse.ok) {
                                alert(`File ${fileName} deleted successfully.`);
                                // Refresh the file list after deletion
                                fetchFiles();
                            } else {
                                const error = await deleteResponse.json();
                                throw new Error(`Failed to delete file: ${error.message}`);
                            }
                        } catch (error) {
                            console.error(error);
                            alert(`Failed to delete file ${fileName}: ${error.message}`);
                        }
                    });

                    li.appendChild(a);
                    li.appendChild(deleteButton);
                    fileList.appendChild(li);
                });

            } catch (error) {
                console.error(error);
                alert(`Failed to fetch files: ${error.message}`);
            }
        }

        // Fetch files on page load
        fetchFiles();
    </script>
</body>
</html>
